pipeline {
    agent any
    environment {
        dockerImageName = "simpleapachehttp"
        dockerbuildversion = "$dockerImageName:v$BUILD_NUMBER"
        dockertag = "${env.BUILD_NUMBER}"
        containername = "apachehttpd"
        reg_password = sh(script: 'echo "ZGNrcl9wYXRfWHNqZjJfR3hsajgzY0RFN05mVC11UDNscFZj".bytes.base64decode().toString()', returnStdout: true, returnStatus: true)
        ereg_password = sh(script: 'echo "ZGNrcl9wYXRfWHNqZjJfR3hsajgzY0RFN05mVC11UDNscFZj".bytes.decodeBase64().toString()', returnStdout: true, returnStatus: true)
    }
    stages {
        stage('Build_Docker_Image') {
            steps {
                script {
                    echo "=== initialize the docker image Build ==="
                    sh 'docker build -t $dockerImageName/$BUILD_NUMBER:latest -f Dockerfile-alphine .'
                    
                }
            }
        }
        stage('Login_Docker_Registry') {
            steps {
                script {
                    echo "=== initialize the docker Registry ==="
                    sh "echo '${containername}'"
                    //sh "docker login -u jithincm -p <>"
                }
            }
        }
        stage('Tag_Docker_Image') {
            steps {
                script {
                    echo "=== initialize the docker tagging Image ==="
                    sh 'docker tag $dockerImageName/$BUILD_NUMBER:latest jithincm/apachehttpd'                  
                }
            }
        }        
        stage('Push_Docker_Image') {
            steps {
                script {
                    echo "=== initialize the docker push Image ==="
                    sh 'docker push jithincm/apachehttpd'                   
                }
            }
        }    
    }
}